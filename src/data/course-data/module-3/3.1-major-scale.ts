/**
 * Module 3, Submodule 3.1: Thang √¢m tr∆∞·ªüng (The Major Scale)
 *
 * Learning Journey:
 * 1. Passive: Animation "scale stairs" with W-W-H-W-W-W-H pattern
 * 2. Guided: Scale Builder - click each note following the formula
 * 3. Interactive: Build major scale from any note on Piano/Guitar
 * 4. Milestone: Play C Major, G Major, F Major consecutively
 *
 * Skipped: Game Journey (to be implemented later)
 */
import type { Submodule } from '../types'

export const SUBMODULE_3_1: Submodule = {
  id: '3.1',
  title: 'Thang √¢m tr∆∞·ªüng',
  description: 'Hi·ªÉu c√¥ng th·ª©c Cung-Cung-N·ª≠a-Cung-Cung-Cung-N·ª≠a (W-W-H-W-W-W-H)',
  sections: ['theory', 'piano', 'guitar', 'abcDemo'],
  theoryContent: `
## 1. Thang √¢m (Scale) l√† g√¨?

### ƒê·ªãnh nghƒ©a

**Thang √¢m (Scale)** l√† m·ªôt chu·ªói c√°c n·ªët ƒë∆∞·ª£c s·∫Øp x·∫øp theo th·ª© t·ª± t·ª´ th·∫•p ƒë·∫øn cao (ho·∫∑c ng∆∞·ª£c l·∫°i), b·∫Øt ƒë·∫ßu v√† k·∫øt th√∫c b·∫±ng n·ªët c√πng t√™n.

> üéº Scale nh∆∞ "b·∫£ng ch·ªØ c√°i" c·ªßa √¢m nh·∫°c - m·ªói gi·ªçng s·ª≠ d·ª•ng m·ªôt t·∫≠p h·ª£p n·ªët ri√™ng!

### Thang √¢m Tr∆∞·ªüng (Major Scale)

**Major Scale** c√≥ √¢m h∆∞·ªüng **vui t∆∞∆°i, s√°ng s·ªßa, ho√†n ch·ªânh**.

{{abc:Thang √¢m C Major - √Çm h∆∞·ªüng vui t∆∞∆°i!|X:1
L:1/4
K:C
C D E F | G A B c|]}}

{{quiz:Thang √¢m Tr∆∞·ªüng (Major Scale) c√≥ √¢m h∆∞·ªüng nh∆∞ th·∫ø n√†o?|Bu·ªìn b√£, u √°m;*Vui t∆∞∆°i, s√°ng s·ªßa;CƒÉng th·∫≥ng, k·ªãch t√≠nh|Major Scale c√≥ √¢m h∆∞·ªüng vui t∆∞∆°i, ho√†n ch·ªânh - kh√°c v·ªõi Minor (bu·ªìn)}}

---

## 2. C√¥ng th·ª©c "v√†ng" W-W-H-W-W-W-H

### Quy t·∫Øc b·∫•t bi·∫øn

M·ªçi thang √¢m tr∆∞·ªüng ƒë·ªÅu ƒë∆∞·ª£c x√¢y d·ª±ng theo **m·ªôt c√¥ng th·ª©c duy nh·∫•t**:

> **W - W - H - W - W - W - H**
>
> W = Whole step (Cung)
> H = Half step (N·ª≠a cung)

### √Åp d·ª•ng v√†o C Major

| B·∫≠c | 1‚Üí2 | 2‚Üí3 | 3‚Üí4 | 4‚Üí5 | 5‚Üí6 | 6‚Üí7 | 7‚Üí8 |
|-----|-----|-----|-----|-----|-----|-----|-----|
| N·ªët | C‚ÜíD | D‚ÜíE | E‚ÜíF | F‚ÜíG | G‚ÜíA | A‚ÜíB | B‚ÜíC |
| Kho·∫£ng c√°ch | **W** | **W** | **H** | **W** | **W** | **W** | **H** |

{{piano:C Major: To√†n b·ªô ph√≠m tr·∫Øng!|C4,D4,E4,F4,G4,A4,B4,C5}}

> üí° **C Major ƒë·∫∑c bi·ªát**: Ch·ªâ d√πng ph√≠m tr·∫Øng v√¨ E-F v√† B-C v·ªën l√† n·ª≠a cung t·ª± nhi√™n!

{{quiz:C√¥ng th·ª©c c·ªßa thang √¢m tr∆∞·ªüng l√† g√¨?|W-H-W-W-H-W-W;*W-W-H-W-W-W-H;H-W-W-W-H-W-W|W-W-H-W-W-W-H = Cung-Cung-N·ª≠a-Cung-Cung-Cung-N·ª≠a}}

{{quiz:Trong c√¥ng th·ª©c W-W-H-W-W-W-H, "H" nghƒ©a l√† g√¨?|Whole step (Cung);*Half step (N·ª≠a cung);High note|H = Half step = N·ª≠a cung. W = Whole step = Cung}}

---

## 3. C Major - Thang √¢m "tr·∫Øng tinh"

### T·∫°i sao C Major l√† c∆° b·∫£n nh·∫•t?

- T·∫•t c·∫£ **7 n·ªët ƒë·ªÅu l√† ph√≠m tr·∫Øng**
- Kh√¥ng c√≥ d·∫•u h√≥a (sharps/flats)
- D·ªÖ nh√¨n, d·ªÖ nh·ªõ, d·ªÖ ch∆°i

{{abc:C Major Scale - ƒêi l√™n v√† xu·ªëng|X:1
M:4/4
L:1/4
K:C
C D E F | G A B c | c B A G | F E D C|]}}

### V·ªã tr√≠ n·ª≠a cung

- **E ‚Üí F** (b·∫≠c 3 ‚Üí 4): N·ª≠a cung th·ª© nh·∫•t
- **B ‚Üí C** (b·∫≠c 7 ‚Üí 8): N·ª≠a cung th·ª© hai

{{piano:N·ª≠a cung trong C Major: E-F v√† B-C|E4,F4,B4,C5}}

{{quiz:Trong √¢m giai C Major, n·ª≠a cung n·∫±m ·ªü v·ªã tr√≠ n√†o?|B·∫≠c 1‚Üí2 v√† 4‚Üí5;*B·∫≠c 3‚Üí4 v√† 7‚Üí8;B·∫≠c 2‚Üí3 v√† 5‚Üí6|N·ª≠a cung lu√¥n ·ªü b·∫≠c 3‚Üí4 (E-F) v√† b·∫≠c 7‚Üí8 (B-C) trong m·ªçi Major Scale}}

---

## 4. G Major - C·∫ßn F#

### T·∫°i sao c·∫ßn F#?

Khi b·∫Øt ƒë·∫ßu t·ª´ G v√† √°p d·ª•ng c√¥ng th·ª©c W-W-H-W-W-W-H:

| B·∫≠c | N·ªët | Kho·∫£ng c√°ch c·∫ßn | Kho·∫£ng c√°ch th·ª±c |
|-----|-----|-----------------|------------------|
| 6‚Üí7 | E‚ÜíF | **W** (cung) | ‚ùå Ch·ªâ c√≥ H (E-F l√† n·ª≠a cung!) |
| 6‚Üí7 | E‚Üí**F#** | **W** (cung) | ‚úÖ E‚ÜíF# = 1 cung |

{{abc:G Major Scale - C√≥ F#|X:1
L:1/4
K:G
G A B c | d e ^f g|]}}

{{piano:G Major: G A B C D E F# G|G3,A3,B3,C4,D4,E4,F#4,G4}}

> üìù **G Major c√≥ 1 d·∫•u thƒÉng**: F# (trong h√≥a bi·ªÉu)

{{quiz:T·∫°i sao G Major c·∫ßn F# thay v√¨ F?|V√¨ F nghe kh√¥ng hay;*V√¨ c√¥ng th·ª©c y√™u c·∫ßu 1 cung ·ªü b·∫≠c 6‚Üí7, m√† E-F ch·ªâ l√† n·ª≠a cung;V√¨ F# d·ªÖ ch∆°i h∆°n|E‚ÜíF ch·ªâ l√† n·ª≠a cung, nh∆∞ng c√¥ng th·ª©c y√™u c·∫ßu 1 cung ‚Üí ph·∫£i n√¢ng F l√™n F#}}

---

## 5. F Major - C·∫ßn Bb

### T·∫°i sao c·∫ßn Bb?

Khi b·∫Øt ƒë·∫ßu t·ª´ F:

| B·∫≠c | N·ªët | Kho·∫£ng c√°ch c·∫ßn | Kho·∫£ng c√°ch th·ª±c |
|-----|-----|-----------------|------------------|
| 3‚Üí4 | A‚ÜíB | **H** (n·ª≠a) | ‚ùå A-B = 1 cung! |
| 3‚Üí4 | A‚Üí**Bb** | **H** (n·ª≠a) | ‚úÖ A‚ÜíBb = n·ª≠a cung |

{{abc:F Major Scale - C√≥ Bb|X:1
L:1/4
K:F
F G A B | c d e f|]}}

{{piano:F Major: F G A Bb C D E F|F3,G3,A3,Bb3,C4,D4,E4,F4}}

> üìù **F Major c√≥ 1 d·∫•u gi√°ng**: Bb (trong h√≥a bi·ªÉu)

{{quiz:F Major c·∫ßn d·∫•u h√≥a g√¨?|F#;*Bb;C#|F Major c·∫ßn Bb v√¨ A‚ÜíB l√† 1 cung, nh∆∞ng c√¥ng th·ª©c y√™u c·∫ßu n·ª≠a cung ·ªü b·∫≠c 3‚Üí4}}

---

## 6. C√°c Scale ph·ªï bi·∫øn kh√°c

### D Major (2 sharps: F#, C#)

{{abc:D Major Scale|X:1
L:1/4
K:D
D E ^F G | A B ^c d|]}}

### Bb Major (2 flats: Bb, Eb)

{{abc:Bb Major Scale|X:1
L:1/4
K:Bb
B c d e | f g a b|]}}

### TƒÉng d·∫ßn s·ªë d·∫•u h√≥a

| Gi·ªçng | S·ªë d·∫•u | D·∫•u h√≥a |
|-------|--------|---------|
| C Major | 0 | (kh√¥ng c√≥) |
| G Major | 1# | F# |
| D Major | 2# | F#, C# |
| A Major | 3# | F#, C#, G# |
| F Major | 1‚ô≠ | B‚ô≠ |
| B‚ô≠ Major | 2‚ô≠ | B‚ô≠, E‚ô≠ |
| E‚ô≠ Major | 3‚ô≠ | B‚ô≠, E‚ô≠, A‚ô≠ |

---

## 7. B·∫≠c c·ªßa thang √¢m (Scale Degrees)

### T√™n g·ªçi c√°c b·∫≠c

| B·∫≠c | S·ªë La M√£ | T√™n ti·∫øng Anh | T√™n ti·∫øng √ù | Vai tr√≤ |
|-----|----------|---------------|-------------|---------|
| 1 | I | Tonic | ƒê√¥ (Do) | N·ªët ch·ªß, "nh√†" |
| 2 | II | Supertonic | R√™ (Re) | Tr√™n Tonic |
| 3 | III | Mediant | Mi (Mi) | Gi·ªØa Tonic v√† Dominant |
| 4 | IV | Subdominant | Fa (Fa) | D∆∞·ªõi Dominant |
| 5 | V | Dominant | Sol (So) | Quan tr·ªçng nh·∫•t sau Tonic |
| 6 | VI | Submediant | La (La) | D∆∞·ªõi Mediant (t·ª´ tr√™n xu·ªëng) |
| 7 | VII | Leading Tone | Si (Ti) | D·∫´n v·ªÅ Tonic |
| 8 | I (octave) | Tonic | ƒê√¥' (Do') | Qu√£ng t√°m |

---

## üéØ T√≥m t·∫Øt

1. **Thang √¢m tr∆∞·ªüng** = Chu·ªói 8 n·ªët v·ªõi √¢m h∆∞·ªüng vui t∆∞∆°i
2. **C√¥ng th·ª©c**: W-W-H-W-W-W-H (Cung-Cung-N·ª≠a-Cung-Cung-Cung-N·ª≠a)
3. **C Major** ƒë·∫∑c bi·ªát: Ch·ªâ d√πng ph√≠m tr·∫Øng
4. **G Major**: C·∫ßn F# ƒë·ªÉ gi·ªØ c√¥ng th·ª©c
5. **F Major**: C·∫ßn Bb ƒë·ªÉ gi·ªØ c√¥ng th·ª©c
6. **N·ª≠a cung** lu√¥n ·ªü v·ªã tr√≠ b·∫≠c 3‚Üí4 v√† b·∫≠c 7‚Üí8

> üí° **M·∫πo nh·ªõ c√¥ng th·ª©c**: "**W**hole-**W**hole-**H**alf | **W**hole-**W**hole-**W**hole-**H**alf" (2-1 | 3-1)
  `,
  abcDemos: [
    {
      id: '3.1.1',
      title: 'C Major Scale',
      description:
        'All white keys! Highlight E-F v√† B-C l√† n·ª≠a cung - ƒë√¢y l√† 2 v·ªã tr√≠ "ƒë·∫∑c bi·ªát" c·ªßa c√¥ng th·ª©c W-W-H-W-W-W-H. C Major l√† scale ƒë·∫ßu ti√™n m·ªçi ng∆∞·ªùi h·ªçc v√¨ kh√¥ng c·∫ßn nh·ªõ d·∫•u h√≥a n√†o!',
      abc: `X:1
M:4/4
L:1/4
K:C
C D E F | G A B c|]`,
      interactive: true,
      playable: true,
    },
    {
      id: '3.1.2',
      title: 'G Major v·ªõi F#',
      description:
        'Demo why F must become F#: Kho·∫£ng c√°ch E‚ÜíF ch·ªâ l√† n·ª≠a cung, nh∆∞ng c√¥ng th·ª©c y√™u c·∫ßu 1 cung ·ªü v·ªã tr√≠ b·∫≠c 6‚Üí7. Gi·∫£i ph√°p: n√¢ng F l√™n th√†nh F#!',
      abc: `X:1
M:4/4
L:1/4
K:G
G A B c | d e ^f g|]`,
      interactive: true,
      playable: true,
    },
    {
      id: '3.1.3',
      title: 'F Major v·ªõi Bb',
      description:
        'Demo why B must become Bb: Kho·∫£ng c√°ch A‚ÜíB l√† 1 cung, nh∆∞ng c√¥ng th·ª©c y√™u c·∫ßu n·ª≠a cung ·ªü v·ªã tr√≠ b·∫≠c 3‚Üí4. Gi·∫£i ph√°p: h·∫° B xu·ªëng th√†nh Bb!',
      abc: `X:1
M:4/4
L:1/4
K:F
F G A B | c d e f|]`,
      interactive: true,
      playable: true,
    },
    {
      id: '3.1.4',
      title: 'Scale Builder',
      description:
        'Interactive: ch·ªçn root note ‚Üí auto-generate scale theo c√¥ng th·ª©c W-W-H-W-W-W-H. B·∫Øt ƒë·∫ßu t·ª´ b·∫•t k·ª≥ n·ªët n√†o, √°p d·ª•ng c√¥ng th·ª©c, v√† b·∫°n c√≥ m·ªôt Major Scale ho√†n ch·ªânh!',
      abc: `X:1
M:4/4
L:1/4
K:D
D E ^F G | A B ^c d|]`,
      interactive: true,
      playable: true,
    },
  ],
  exercises: [
    {
      type: 'note-id',
      notes: ['C4', 'D4', 'E4', 'F4', 'G4', 'A4', 'B4'],
      questionCount: 5,
    },
  ],
}
